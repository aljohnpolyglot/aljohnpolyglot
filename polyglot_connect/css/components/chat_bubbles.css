/* Improved CSS for chat bubbles */

/* Common container for chat messages */
.chat-log-area {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md); /* Increased gap between messages */
    padding: var(--spacing-lg); /* More padding inside the log area */
    background-color: var(--bg-light-secondary); /* Subtle background for the chat area */
    border-radius: var(--border-radius-lg); /* Rounded corners for the chat area */
    box-shadow: var(--shadow-md); /* Add depth to the chat area */
}

/* General chat bubble styling */
.chat-message-ui {
    padding: var(--spacing-md) var(--spacing-lg); /* Increased padding for bubbles */
    border-radius: var(--border-radius-lg); /* Rounded bubbles */
    max-width: 70%; /* Slightly narrower bubbles */
    word-wrap: break-word;
    line-height: 1.6; /* Improved readability */
    font-size: 1rem; /* Slightly larger text */
    box-shadow: var(--shadow-sm); /* Subtle shadow for bubbles */
    position: relative; /* For potential timestamp or tail */
    margin: var(--spacing-sm) 0; /* Add vertical spacing between bubbles */
}

/* User's messages */
.chat-message-ui.user,
.chat-message-ui.user-audio {
    background-color: var(--primary-color);
    color: var(--text-color-light);
    border-bottom-right-radius: var(--border-radius-sm); /* "Tail" effect */
    align-self: flex-end; /* Align to the right */
    margin-left: auto; /* Push to right */
}

/* Connector/AI's messages */
.chat-message-ui.connector,
.chat-message-ui.tutor,
.chat-message-ui.connector-thinking {
    background-color: var(--bg-light);
    color: var(--text-color-dark);
    border-bottom-left-radius: var(--border-radius-sm); /* "Tail" effect */
    align-self: flex-start; /* Align to the left */
    margin-right: auto; /* Push to left */
    border: 1px solid var(--border-color-light);
}

/* Thinking animation for AI */
.chat-message-ui.connector-thinking {
    font-style: italic;
    background-color: var(--secondary-color-lighter);
    color: var(--text-color-muted);
}
.chat-message-ui.connector-thinking::after {
    content: '.';
    display: inline-block;
    animation: thinking-dots 1.5s infinite steps(3, end);
    vertical-align: bottom;
}
@keyframes thinking-dots {
    0% { content: '.'; }
    33% { content: '..'; }
    66% { content: '...'; }
}

/* Group chat message styling */
#group-chat-log .chat-message-ui {
    max-width: 85%; /* Wider bubbles for group messages */
}
#group-chat-log .chat-message-ui strong {
    display: block;
    font-size: 0.9em;
    margin-bottom: var(--spacing-xs);
    color: var(--primary-color);
    font-weight: var(--font-weight-bold);
}

/* Dark Mode for Chat Bubbles */
body.dark-mode .chat-log-area {
    background-color: var(--bg-dark-secondary);
}
body.dark-mode .chat-message-ui.user,
body.dark-mode .chat-message-ui.user-audio {
    background-color: var(--primary-color-dark);
    color: var(--text-color-light);
}
body.dark-mode .chat-message-ui.connector,
body.dark-mode .chat-message-ui.tutor,
body.dark-mode .chat-message-ui.connector-thinking {
    background-color: var(--bg-dark-tertiary);
    color: var(--text-color-light);
    border-color: var(--border-color-dark);
}

/* Image in chat */
.activity-area-style img {
    border: 1px solid var(--border-color-light);
    padding: var(--spacing-xs);
    background-color: var(--bg-white);
    border-radius: var(--border-radius-sm);
}
body.dark-mode .activity-area-style img {
    border-color: var(--border-color-dark);
    background-color: var(--bg-dark-tertiary);
}