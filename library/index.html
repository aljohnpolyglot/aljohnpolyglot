<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aljohn Polyglot Library - High Seas Edition</title>
    <!-- Global Styles -->
       <link rel="icon" href="../images/channel_profile_aljohn_polyglot.png" type="image/png">
    <link rel="stylesheet" href="css/global.css">
    <!-- Section Specific Styles -->
    <link rel="stylesheet" href="css/hero.css">
    <link rel="stylesheet" href="css/tips.css">
    <link rel="stylesheet" href="css/library-layout.css">
    <link rel="stylesheet" href="css/filters.css">
    <link rel="stylesheet" href="css/book-card.css">
    <link rel="stylesheet" href="css/character-panel.css">
      <link rel="stylesheet" href="css/story-launchpad.css">
    <link rel="stylesheet" href="css/philosophy-section.css">
    <link rel="stylesheet" href="css/treasure-section.css">
    <link rel="stylesheet" href="css/modal.css">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&family=Pirata+One&family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Merriweather+Sans:wght@400;600;700&family=Pirata+One&family=Seaweed+Script&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/library-navbar-footer.css">
</head>
<body>

     <header id="main-header-placeholder"></header>
     
    <div id="page-container">

        <!-- 1. Hero Section (Top Banner) -->
        <header id="hero-section">
            <div class="hero-background"></div>
            <div class="hero-content-wrapper">
                <div class="hero-text-panel">
                    <h1 class="library-title">Aljohn Polyglot Library</h1>
                    <h2 class="headline">Your Treasure Map to Free Multilingual Reading!</h2>
                    <p class="sub-headline">
                        Welcome aboard! Discover a vast hoard of public domain books, spanning the languages Aljohn speaks and many more. All freely accessible. Our dedicated "crew" of linguistic champions (meet them below!) scours the world to bring you these timeless stories, philosophies, and insights, ensuring they're available to every curious mind, in every tongue, without cost or constraint. Drop anchor and explore a world where reading is truly free.
                    </p>
                    <a href="#library-main-section" class="cta-button main-cta">Explore the Free Collection</a>
                </div>
                <div class="hero-ship-panel">
                    <img src="images/assets/library_ship.png" alt="Aljohn's Library Ship" id="library-ship-icon">
                    <div id="floating-flags-container">
                        <!-- Flags will be dynamically added here -->
                    </div>
                </div>
            </div>
        </header>

        <!-- 2. Tips Section -->
        <section id="tips-section">
            <div class="tip-card-container">
                <div class="tip-card immersive-translate-card current-tip">
                    <div class="tip-icon-container">
                        <img src="images/assets/immersive_translate_chest.png" alt="Immersive Translate Treasure Chest" class="tip-icon">
                    </div>
                    <div class="tip-text-content">
                        <h3>You found the treasure… but not in your language?</h3>
                        <p>Set sail with Immersive Translate and read across borders.</p>
                        <a href="https://app.immersivetranslate.com/" target="_blank" class="tip-button">Click here for Immersive Translate</a>
                    </div>
                </div>
                <div class="tip-card readera-card">
                     <div class="tip-icon-container">
                        <img src="images/assets/read_era_podium.png" alt="ReadEra App Podium" class="tip-icon">
                    </div>
                    <div class="tip-text-content">
                        <h3>Chart Your Reading Course!</h3>
                        <p>Use a versatile reader like ReadEra to navigate your EPUBs & PDFs. Captain Aljohn's choice for offline adventures!</p>
                        <a href="https://readera.org/" target="_blank" class="tip-button">Discover ReadEra</a>
                    </div>
                </div>
            </div>
            <div class="tip-switcher">
                <button class="tip-dot active" data-tip="0"></button>
                <button class="tip-dot" data-tip="1"></button>
            </div>
        </section>

     <!-- 3. Main Library and Filters -->
        <main id="library-main-section">
            <aside id="filters-sidebar">
                <h2>Adjust Your Spyglass</h2> <!-- Or your chosen title -->

                <div class="filter-group">
                    <label for="language-filter"> <i class="fas fa-flag"></i> Select Language:</label>
                    <select id="language-filter" name="language">
                        <option value="">All Tongues</option>
                        <!-- Options populated by JS -->
                    </select>
                </div>

                <!-- NEW: Search Bar -->
                <div class="filter-group" id="search-filter-group">
                    <label for="search-bar-input"><i class="fas fa-search"></i> Search Titles/Authors:</label>
                    <div class="search-bar-wrapper">
                        <input type="search" id="search-bar-input" placeholder="e.g., Don Quijote, Cervantes">
                        <button id="search-bar-btn" aria-label="Search"><i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
                <!-- END NEW: Search Bar -->

                <div class="filter-group">
                    <label for="genre-filter"><i class="fas fa-scroll"></i> Filter by Genre:</label>
                    <select id="genre-filter" name="genre">
                        <option value="">All Scrolls</option>
                        <!-- Options populated by JS -->
                    </select>
                </div>

                <div class="filter-group">
                    <label for="filetype-filter"><i class="fas fa-file-alt"></i> Manuscript Type:</label>
                    <select id="filetype-filter" name="filetype">
                        <option value="">Any Format</option>
                        <option value="pdf">PDF Parchments</option>
                        <option value="epub">EPUB Codices</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="cefr-filter"><i class="fas fa-layer-group"></i> CEFR Level:</label>
                    <select id="cefr-filter" name="cefr">
                        <option value="">All Levels</option>
                        <!-- Options populated by JS -->
                    </select>
                </div>
                <button id="reset-filters-btn"><i class="fas fa-undo"></i> Clear Charts</button>
            </aside>

            <section id="library-content-area">
                <div id="library-main-message-area">
                    <!-- Content here will be set by JavaScript -->
                </div>
                <div id="library-grid" class="book-grid-container" style="display: none;">
                    <!-- Book cards will be dynamically inserted here -->
                </div>
                <div id="pagination-controls" style="display: none;">
                    <button id="prev-page-btn" disabled>« Previous Page</button>
                    <span id="page-info">Page 1 of 1</span>
                    <button id="next-page-btn" disabled>Next Page »</button>
                </div>
            </section>

            <aside id="character-panel-sidebar" style="display: none;">
                <div id="character-info">
                    <img src="" alt="Character Portrait" id="character-portrait-img"> <!-- Portrait on its own line -->
                    <div id="character-name-line"> <!-- New container for flag and name -->
                        <!-- Flag will be prepended here by JS -->
                        <h3 id="character-name-display"></h3>
                    </div>
                </div> <!-- ***** THIS CLOSING DIV WAS MISSING for #character-info ***** -->
                
                <div id="chatbot-interface">
                    <div id="chat-log-display">
                        <!-- Chat messages appear here -->
                    </div>
                    <div id="chat-input-container">
                        <input type="text" id="user-chat-input-field" placeholder="Ask or practice...">
                        <button id="send-chat-message-btn"><i class="fas fa-paper-plane"></i></button>
                    </div>
                    <p class="api-note">Our linguist awaits your query.</p> <!-- Simplified API note -->
                </div>
            </aside>
        </main>

<!-- Captain Aljohn's Treasure Isles: Your First Story Adventures! -->
<section id="treasure-isles-stories-section"> 
    <!-- Background applied via CSS -->

    <!-- THIS WRAPPER REMAINS THE MAIN FLEX CONTAINER FOR THE TWO COLUMNS -->
    <div class="treasure-isles-layout-wrapper"> 

        <!-- Left Column: NOW INCLUDES Title, Subtitle, AND Carousel -->
        <div class="treasure-isles-content-column">
            <div class="section-title-container treasure-isles-title-container"> <!-- MOVED HERE -->
                <h2 class="section-title">Captain Aljohn's Treasure Isles</h2> 
                <p class="section-subtitle treasure-isles-subtitle">
                   "When first exploring a new tongue, I always look for graded stories like these," notes Captain Aljohn. "They're like finding the first clues on a treasure map – simple, engaging, and the perfect way to start your linguistic adventure with a rewarding discovery."
                </p>
            </div>

            <div class="story-carousel-wrapper"> 
                <div id="olly-stories-carousel" class="story-carousel-container">
                    <!-- Book "cards" (cover + lang) will be populated here by JS -->
                </div>
                <button class="carousel-arrow prev" id="olly-carousel-prev" aria-label="Previous Story">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="carousel-arrow next" id="olly-carousel-next" aria-label="Next Story">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>

        <!-- Right Column: Treasure Chest Visual (Stays the same) -->
        <div class="treasure-isles-visual-column">
            <img src="images/assets/your_large_treasure_chest.png" alt="A chest overflowing with story books!" id="main-treasure-chest-image"> 
        </div>
    </div>
</section>
        <!-- === END NEW SECTION PLACEMENT === -->
        <!-- Hidden Treasure Section -->
      <!-- Captain Aljohn's Cove - Revamped Hidden Treasure Section -->
<!-- Captain Aljohn's Cove - Revamped Hidden Treasure Section -->
<!-- Captain Aljohn's Cove - Revamped Hidden Treasure Section -->
<!-- Captain Aljohn's Cove - Revamped Hidden Treasure Section -->
<section id="aljohns-cove-section">
    <div class="section-title-container">
        <div class="title-and-subtitle">
            <h2 class="section-title">Captain Aljohn's Cove of Curiosities</h2>
            <p class="section-subtitle">Keep chattin' with the old salt – he might just spill the beans on where the real treasure maps lie!</p>
        </div>
    </div>

    <!-- This main interaction area will now stack its children -->
    <div id="aljohn-interaction-area" class="cove-stacked-layout">
        <!-- Captain Aljohn Visual - Will appear to merge with bubble -->
        <div id="aljohn-visual-container"> 
            <img src="images/assets/captain_aljohn_transparent.png" alt="Captain Aljohn" id="aljohn-main-character-image">
        </div>

        <!-- Speech Bubble and Actions - Will be 'behind' or 'connected to' Aljohn's bottom -->
        <div id="aljohn-dialogue-container">
            <div id="aljohn-speech-bubble-area">
                <div class="speech-bubble-content">
                    <p id="aljohn-dialogue-text">Welcome, seeker! Ready for a riddle that'll test yer wits?</p>
                </div>
                <p id="aljohn-cove-hint-display" class="cove-hint" style="display:none;">(Psst...)</p>
                <p id="aljohn-cove-answer-display" class="cove-answer" style="display:none;">The answer be...</p>
            </div>
            <div id="aljohn-cove-actions">
                <button id="next-aljohn-entry-btn" class="cove-button">Aye, More Wisdom, Captain!</button>
                <button id="reveal-cove-hint-btn" class="cove-button" style="display:none;">Show Hint</button>
                <button id="reveal-cove-answer-btn" class="cove-button" style="display:none;">Reveal Answer</button>
            </div>
        </div>
    </div>
</section>

  <!-- Language Learning Philosophies Section -->
       <!-- Captain Aljohn's Navigational Aids: Charts for the Mind -->
<section id="navigational-aids-section">
    <div class="section-title-container">
        <!-- Optional: A small thematic icon like a sextant or spyglass -->
        <!-- <img src="images/assets/sextant_icon.png" alt="Navigational Tool Icon" class="nav-aid-title-icon"> -->
        <h2 class="section-title">Captain Aljohn's Navigational Aids</h2>
        <p class="section-subtitle">Modern charts for mastering the currents of language and thought. These ain't stored on me ship, but they be vital for any serious voyage!</p>
    </div>

    <div class="bookshelf-wrapper"> <!-- For horizontal scrolling -->
        <div id="navigational-aids-shelf" class="bookshelf-container">
            <!-- Philosophy/Navigational Aid book cards will be populated here by JS -->
            <!-- Each card will be a "book" on the shelf -->
        </div>
    </div>
</section>

       
    <!-- Book Modal Structure (hidden by default) -->
    <div id="book-info-modal" class="modal-overlay">
        <div class="modal-content-box">
            <button class="close-modal-button">×</button>
            <div class="modal-book-layout">
                <div class="modal-cover-container">
                    <img src="" alt="Book Cover" id="modal-book-cover-img">
                </div>
                <div class="modal-details-container">
                    <h2 id="modal-book-title-text"></h2>
                    <p class="modal-genre-eyebrow-text"></p>
                    <p id="modal-book-language-display"></p>
                    <div class="modal-description-scroll">
                        <p id="modal-book-description-text"></p>
                    </div>
                    <div id="aljohns-notes-modal-section">
                        <h4><i class="fas fa-feather-alt"></i> Captain Aljohn's Notes:</h4>
                        <p id="modal-aljohns-notes-text"></p>
                    </div>
                    <div class="modal-download-actions">
                        <a href="#" id="modal-epub-download-btn" class="download-btn" target="_blank" download style="display:none;">Download EPUB <i class="fas fa-book-reader"></i></a>
                        <a href="#" id="modal-pdf-download-btn" class="download-btn" target="_blank" download style="display:none;">Download PDF <i class="fas fa-file-pdf"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Character Bio Modal Structure (hidden by default) -->
    <div id="character-bio-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content-box character-modal-content">
            <button class="close-modal-button" id="close-character-bio-modal">×</button>
            <div class="modal-character-layout">
                <div class="modal-character-portrait-container">
                    <img src="" alt="Character Full Portrait" id="modal-character-full-img">
                </div>
            <div class="modal-character-details-container">
    <div id="modal-character-name-container"> <!-- New container -->
        <!-- Flag will be prepended here by JS -->
        <h2 id="modal-character-name"></h2>
    </div>
    <p class="modal-character-title-text"></p>
                    <div class="modal-bio-scroll">
                        <p id="modal-character-bio-long"></p>
                    </div>
                    <div id="modal-character-quotes-section">
                        <h4><i class="fas fa-quote-left"></i> Wisdom from the Seas:</h4>
                        <ul id="modal-character-quotes-list">
                            <!-- Quotes will be populated here -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic Content Modal -->
<div id="content-info-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content-box wide-modal-content"> <!-- Added 'wide-modal-content' for potentially more text -->
        <button class="close-modal-button" id="close-content-modal">×</button>
        <div id="content-modal-body">
            <!-- Content will be dynamically inserted here -->
            <!-- Example structure for a philosophy book:
            <div class="modal-book-layout philosophy-modal-layout">
                <div class="modal-cover-container">
                    <img src="" alt="Book Cover" id="modal-content-cover-img">
                </div>
                <div class="modal-details-container">
                    <h2 id="modal-content-title-text"></h2>
                    <p class="modal-author-text">by <span id="modal-content-author"></span></p>
                    
                    <h4>Book Description:</h4>
                    <div class="modal-description-scroll">
                        <p id="modal-content-description-text"></p>
                    </div>

                    <h4>Captain Aljohn's Log: Why This Chart Matters</h4>
                    <div class="modal-description-scroll aljohns-notes-scroll">
                        <p id="modal-content-aljohns-notes-text"></p>
                    </div>
                    
                    <div class="modal-external-actions">
                        <a href="#" id="modal-content-amazon-link" class="button-like-link amazon-link" target="_blank" rel="noopener noreferrer" style="display:none;">
                            View on Amazon <i class="fab fa-amazon"></i>
                        </a>
                    </div>
                </div>
            </div>
            -->
        </div>
    </div>
</div>
<footer id="page-footer"> <!-- <<<< ADD ID HERE -->
    <div id="main-footer-placeholder"></div> 
</footer>

<script>
    let siteBasePath;
    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' || window.location.protocol === 'file:') {
        siteBasePath = '/';
    } else {
        siteBasePath = '/aljohnpolyglot/'; // Your GitHub repository name
    }
    console.log("Global siteBasePath dynamically set to:", siteBasePath);
</script>
    <!-- JavaScript Files: LOAD DATA FIRST, THEN UTILS, THEN FEATURES, THEN MAIN APP -->
  <script src="../js/navbar-loader.js" defer></script>
<script src="../js/footer-loader.js" defer></script> <!-- Data Files -->
    <script src="js/data/book_data.js"></script>
        <script src="js/data/olly_richards_books_data.js"></script>
    <script src="js/data/character_data.js"></script>
    <script src="js/data/philosophy_book_data.js"></script>

    <!-- Utility Scripts -->
    <script src="js/utils/dom_helpers.js"></script>
    <script src="js/utils/flag_cdn_helper.js"></script>

    <!-- Feature Specific Scripts -->
    <script src="js/features/hero_animations.js"></script>
    <script src="js/features/tips_switcher.js"></script>
    <script src="js/features/filter_population.js"></script>
    <script src="js/features/library_manager.js"></script>
    <script src="js/features/character_manager.js"></script>
    <script src="js/features/chatbot_gemini.js"></script>
    <script src="js/features/philosophy_display.js"></script>
    <script src="js/features/treasure_interaction.js"></script>
    <script src="js/features/modal_controller.js"></script>
 <script src="js/features/story_launchpad_display.js"></script>
   <script src="js/features/navigational_aids_display.js"></script>
    <!-- Main Application Initializer (LAST SCRIPT TO LOAD) -->
    <script src="js/main_app.js"></script>

     
</body>
</html>